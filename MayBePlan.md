# 集中式博客与分布式论坛  
---
满足某些想要拥有个人站点又想有人互动的扭曲需求XD  
满足逃离第三方平台的数据垄断又无力维护高配服务器的扭曲需求XD  

## 尝试阐述

### 背景

假设有abc三个站点，每个站点都有独立完整的博客（blog）功能，站长（owner）可以发布文章（post）和自己独特页面（single page），每篇文章都会归入某个分类（category），文章下设评论区（comment）。  
现在，我们增加一个称呼，我们将分类称为版块（forum），将文章称为主题（topic），而评论区则自然而然地成为了主题下的回复（reply）。  
**注意：下文将根据语境随时切换用词，但两种用词的含义等同，比如一个主题等价于一篇文章**

### 博客部分

与大多数个人博客相同，以站长为中心，文章大都或全部由站长发布，其他用户多为阅读和评论。

### 分布式论坛部分

#### 主题同步

可以理解为将友链功能进行极大加强，允许多个站点维护同一个板块或主题，数据的具体存储位置由站长决定。  
假设a发布了一个主题，名为topic1，b可以选择复制（clone）topic1至自己的站点。经过ab协商可以选择将两个站点的topic1进行实时数据同步或手动更新，在实时同步模式下任一站点出现新回复都会立刻同步至其他站点。在手动更新模式下a可以拉取（pull）b的更新。根据协商，b可以推送（push）更新至a或请求a拉取自己的更新（pull request)。
同样c可以复制a或b的topic1至自己的站点，假设c复制了b的topic1，ab之间使用自动更新，bc之间使用手动更新，a的新回复会自动更新至b，b的新回复会自动更新至a，c的新回复不会触发自动行为。  

#### 鉴权与博主动态

*有待考量*  
站点间通过域名和一个额外公钥验证自己的身份。任意两站点在首次交换数据前都会先将对方加入信任的已知站点。假设ab已经互相信任，a的私钥丢失或域名更换都会导致b需要手动确认a的变化才能继续交换数据，否则b将把a当作新站点d处理。（通过站长在b上的绑定账号找回也许可行）
假设a的站长账号为A，A可以通过OAuth登录b，随后A在b上的回复会自动同步至a并默认在站长动态中显示。

#### 非站长用户的账号漂移与防篡改

新用户注册时上传一个RSA公钥或服务器创建一个RSA公钥作为用户的唯一身份标识，用户可以选择将私钥保存在本地或多个信任服务器，并且可以独立登录任意一个信任服务器，用户发布的所有文本都通过私钥加密。
假设a有一个A发布的topic2，b已经实时同步topic2，当c拉取b的topic2时会发现包含未知用户A，随后向A的注册站点a验证有关A的信息，如果验证通过即保存，如果验证失败即拉取失败并向a发出警告。
只要A拥有自己的私钥，A就可以新增信任新服务器并登录，但如果信任服务器全部下线，A本地也没有私钥，A将无法以自己的身份登录。

#### 探索

每个站点都在一个固定位置发布rss信息，a已经添加了一些信任站点，在探索页面，a会从信任站点获取rss并整合为动态以方便用户互动

### im 部分

客户端对服务端进行轮询以增加消息同步速度，这样就允许了用户在线讨论